<!DOCTYPE html>
<html lang=zh-CN>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <!-- <link rel="shortcut icon" href="/img/favicon.ico"> -->
    <link rel="shortcut icon" href="https://q2.qlogo.cn/headimg_dl?dst_uin=1740674168&spec=140" type="image/jpeg">

    <title>
        
        AMG代数多重网格学习 - Vicczyq | 记录学习和生活
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    









<meta name="generator" content="Hexo 7.1.0"></head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 好好生活，保持热爱，无惧无畏，奔赴山海 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="//q2.qlogo.cn/headimg_dl?dst_uin=1740674168&amp;spec=140" />
        </div>
        <div class="name">
            <i>Vicczyq | 长木乔</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>收藏</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80amg%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3"><span class="toc-text">一、AMG基本思想</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0"><span class="toc-text">1.1 基本概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E"><span class="toc-text">1.2 补充说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-text">1.3 例子</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E7%B2%97%E7%BD%91%E6%A0%BC%E9%80%89%E6%8B%A9"><span class="toc-text">二、粗网格选择</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ruge-stuben%E7%AE%97%E6%B3%95"><span class="toc-text">2.1 Ruge-Stuben算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%BA%E8%BF%9E%E6%8E%A5%E5%AE%9A%E4%B9%89"><span class="toc-text">2.1.1 强连接定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E6%AD%A5%E9%AA%A4"><span class="toc-text">2.2.2 算法步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pmis-%E7%AE%97%E6%B3%95"><span class="toc-text">2.2 PMIS 算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E6%8F%92%E5%80%BC%E7%AE%97%E5%AD%90"><span class="toc-text">三、插值算子</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-1"><span class="toc-text">3.1 例子</span></a></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 好好生活，保持热爱，无惧无畏，奔赴山海 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        AMG代数多重网格学习
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2025-11-28 17:58:46</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#线性代数" title="线性代数">线性代数</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h1 id="一amg基本思想">一、AMG基本思想</h1>
<h2 id="基本概述">1.1 基本概述</h2>
<p>AMG是一种<strong>不依赖于网格几何信息</strong>的多重网格法，完全基于矩阵
<em>A</em>的代数结构来构造粗网格、限制算子、延拓算子等。</p>
<p>主要步骤：</p>
<ul>
<li><strong>光滑（Smooth）</strong>：在细网格上用简单迭代法（如
Gauss-Seidel）消去高频误差</li>
<li><strong>粗网格校正（Coarse
Correction)</strong>：将残差限制到粗网格上，在粗网格上求解误差方程，再插值回细网格修正解。</li>
<li><strong>循环迭代：</strong>常见为W-cycle、V-cycle、F-cycle</li>
</ul>
<figure>
<img src="/2025/11/28/AMG%E4%BB%A3%E6%95%B0%E5%A4%9A%E9%87%8D%E7%BD%91%E6%A0%BC%E5%AD%A6%E4%B9%A0/R.jpeg" alt="img">
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h2 id="补充说明">1.2 补充说明</h2>
<p>当使用有限差分法、有限元法等数值方法时，控制方程（如热传导方程、波动方程）会被离散化，最终转化为一个大规模的线性方程组
<code>A x = b</code></p>
<p>矩阵<code>A</code>包含了网格点的连接关系以及物理方程的信息</p>
<p>矩阵中每一行对应一个网格点上的离散方程（可以理解为一个点或Cell）</p>
<p>非零元素表示该点与其相邻点之间的耦合关系</p>
<h2 id="例子">1.3 例子</h2>
<p><span class="math display">\[
A = \begin{bmatrix}
2 &amp; -1 &amp; 0 \\
-1 &amp; 2 &amp; -1 \\
0 &amp; -1 &amp; 2
\end{bmatrix},
\quad b = \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}.
\]</span></p>
<p><strong>第一步：光滑化</strong></p>
<p>初始猜测<span class="math inline">\(x^{(0)} = [0,0,0]^T\)</span></p>
<p>用一次 <strong>GaussSeidel</strong> 迭代（光滑） <span class="math display">\[
x_i^{(new)} = \frac{1}{a_{ii}} \left( b_i - \sum_{j&lt;i} a_{ij}
x_j^{(new)} - \sum_{j&gt;i} a_{ij} x_j^{(old)} \right)
\]</span></p>
<ul>
<li><span class="math inline">\(i = 1:x_1=(1-0)/2=0.5\)</span></li>
<li><span class="math inline">\(i=2:x_2=(2-(-1)*0.5-0)/2=1.25\)</span></li>
<li><span class="math inline">\(i=3:x_3=(3-(-1)*1.25-0)/2=2.125\)</span></li>
</ul>
<p>所以一次光滑后： <span class="math display">\[
x^{(1)} = [0.5, 1.25, 2.125]^T
\]</span> 计算残差<span class="math inline">\(r = b - A
x^{(1)}\)</span>： <span class="math display">\[
A x^{(1)} =
\begin{bmatrix}
2\cdot 0.5 - 1\cdot 1.25 + 0 \\
-1\cdot 0.5 + 2\cdot 1.25 - 1\cdot 2.125 \\
0 - 1\cdot 1.25 + 2\cdot 2.125
\end{bmatrix}
=
\begin{bmatrix}
1.0 - 1.25 \\
-0.5 + 2.5 - 2.125 \\
-1.25 + 4.25
\end{bmatrix}
=
\begin{bmatrix}
-0.25 \\
-0.125 \\
3.0
\end{bmatrix} \\
r = b - A x^{(1)} =
\begin{bmatrix}
1 - (-0.25) \\
2 - (-0.125) \\
3 - 3
\end{bmatrix}
=
\begin{bmatrix}
1.25 \\
2.125 \\
0
\end{bmatrix}
\]</span> <strong>第二步：粗网格选取</strong></p>
<p>选点1,3作为粗网格点（C点），点2作为细网格点（F点）</p>
<p>即粗网格是 {1,3}，细网格是 {2}。</p>
<p><strong>第三步：构造插值算子P</strong></p>
<p>AMG 中，插值公式（直接插值简化版）：</p>
<p>对 F 点 <em>i</em>，其值由相邻 C 点插值。这里 F 点 i=2，相邻 C 点是 1
和 3。 <span class="math display">\[
w_{2 \to 1} = \frac{a_{21} }{ a_{21} + a_{23}
} = \frac{1}{1+1} = 0.5
\\
w_{2 \to 3} = 0.5
\]</span> （更精确的公式要考虑强连接，这里简单用对称等权）</p>
<p>所以插值矩阵 <em>P</em>（细→粗编号映射：粗点 1→粗网格索引 1，粗点
3→粗网格索引 2，F 点 2 对应一行插值公式）： <span class="math display">\[
P = \begin{bmatrix}
1 &amp; 0 \\
0.5 &amp; 0.5 \\
0 &amp; 1
\end{bmatrix}
\]</span> 含义：粗网格函数 <span class="math inline">\(u_c = [u_{c1},
u_{c2}]^T\)</span> 延拓到细网格： <span class="math display">\[
u_1 = u_{c1},u_2 = 0.5 u_{c1} + 0.5 u_{c2},u_3 = u_{c2}
\]</span> <strong>第四步：限制算子R</strong></p>
<p>常用 <span class="math inline">\(R = P^T\)</span>（Galerkin 粗化）：
<span class="math display">\[
R = P^T = \begin{bmatrix}
1 &amp; 0.5 &amp; 0 \\
0 &amp; 0.5 &amp; 1
\end{bmatrix}
\]</span> <strong>第五步：构建粗网格</strong></p>
<p>先算<span class="math inline">\(AP\)</span>： <span class="math display">\[
A P =
\begin{bmatrix}
2 &amp; -1 &amp; 0 \\
-1 &amp; 2 &amp; -1 \\
0 &amp; -1 &amp; 2
\end{bmatrix}
\begin{bmatrix}
1 &amp; 0 \\
0.5 &amp; 0.5 \\
0 &amp; 1
\end{bmatrix}
=  
\begin{bmatrix}
1.5 &amp; -0.5 \\
0 &amp; 0 \\
-0.5 &amp; 1.5
\end{bmatrix}
\]</span></p>
<p>再乘 <span class="math inline">\(R = P^T\)</span>： <span class="math display">\[
A_c = R (A P) =
\begin{bmatrix}
1 &amp; 0.5 &amp; 0 \\
0 &amp; 0.5 &amp; 1
\end{bmatrix}
\begin{bmatrix}
1.5 &amp; -0.5 \\
0 &amp; 0 \\
-0.5 &amp; 1.5
\end{bmatrix}
=
\begin{bmatrix}
1.5 &amp; -0.5 \\
-0.5 &amp; 1.5
\end{bmatrix}
\]</span> <strong>第六步：粗网格计算</strong></p>
<p>粗网格方程：<span class="math inline">\(A_c e_c = r_c\)</span>，其中$
r_c = Rr $ <span class="math display">\[
r_c = Rr =
\begin{bmatrix}
1 &amp; 0.5 &amp; 0 \\
0 &amp; 0.5 &amp; 1
\end{bmatrix}
\begin{bmatrix}
1.25 \\
2.125 \\
0
\end{bmatrix}
=
\begin{bmatrix}
1.25 + 0.5\cdot 2.125 \\
0.5\cdot 2.125 + 0
\end{bmatrix}
=
\begin{bmatrix}
1.25 + 1.0625 \\
1.0625
\end{bmatrix}
=
\begin{bmatrix}
2.3125 \\
1.0625
\end{bmatrix}
\]</span> 求解<span class="math inline">\(A_c e_c = r_c\)</span>: <span class="math display">\[
1.5 e_1 - 0.5 e_2 = 2.3125 \\
-0.5 e_1 + 1.5 e_2 = 1.0625
\]</span> 所以粗网格修正 <span class="math inline">\(e_c = [2,
1.375]^T\)</span>。</p>
<p><strong>第七步：插值到细网格</strong></p>
<p>细网格误差 <span class="math inline">\(e = P e_c\)</span>： <span class="math display">\[
e = \begin{bmatrix}
1 &amp; 0 \\
0.5 &amp; 0.5 \\
0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
2 \\
1.375
\end{bmatrix}
=
\begin{bmatrix}
2 \\
1.6875 \\
1.375
\end{bmatrix}
\]</span> <strong>第八步：修正解</strong> <span class="math display">\[
x^{(2)} = x^{(1)} + e =
[0.5+2, \ 1.25+1.6875, \ 2.125+1.375]^T
= [2.5, 2.9375, 3.5]^T
\]</span>
第二个分量还有误差，但第一个和第三个已经精确。我们的粗网格选取和光滑组合还需要多次
V-cycle。</p>
<h1 id="二粗网格选择">二、粗网格选择</h1>
<h2 id="ruge-stuben算法">2.1 Ruge-Stuben算法</h2>
<p>这是经典AMG的核心算法，用强弱连接性来自动选择C/F点。</p>
<h3 id="强连接定义">2.1.1 强连接定义</h3>
<p>点 <em>i</em>和点 <em>j</em>是<strong>强连接</strong>的，如果： <span class="math display">\[
a_{ij} \geq \theta \cdot \max_{k \neq i} a_{ik}
\]</span> 其中 <span class="math inline">\(θ\)</span>
为强度阈值(自定义)，通常取0.25~0.5</p>
<p>对于矩阵： <span class="math display">\[
A = \begin{bmatrix}
2 &amp; -1 &amp; 0 \\
-1 &amp; 2 &amp; -1 \\
0 &amp; -1 &amp; 2
\end{bmatrix}
\]</span> 每行的非对角元绝对值：行1: {1}, 行2: {1,1}, 行3: {1}。</p>
<p>取 <em>θ</em>=0.3：</p>
<ul>
<li>点1的强连接：1≥0.3×1→ 点2是强连接</li>
<li>点2的强连接：1≥0.3×1→ 点1和点3都是强连接</li>
<li>点3的强连接：点2是强连接</li>
</ul>
<p>强连接图：1—2—3</p>
<h3 id="算法步骤">2.2.2 算法步骤</h3>
<ol type="1">
<li><strong>初始化：</strong>
<ul>
<li>所有点标记为“未定义”</li>
<li>计算每个点的权重$_i = $强连接数</li>
<li>所以权重：<span class="math inline">\(\lambda_1 = 1, \lambda_2 = 2,
\lambda_3 = 1\)</span></li>
</ul></li>
<li><strong>选择C点</strong>
<ul>
<li>选择权重最大的点作为第一个C点（点2）</li>
<li>将点2的强连接邻居（点1,3）标记为F点</li>
</ul></li>
</ol>
<h2 id="pmis-算法">2.2 PMIS 算法</h2>
<p>待续...</p>
<h1 id="三插值算子">三、插值算子</h1>
<p>对于细网格点（F点）： <span class="math display">\[
u_2 = -\frac{\sum_{j \in C_2} a_{ij} u_j + \sum_{k \in F_2^s} a_{ik}
\left( -\frac{\sum_{m \in C_k} a_{km} u_m}{a_{kk}} \right)}{a_{ii} +
\sum_{k \in F_2^w} a_{ik}}
\]</span> 其中$ F_2^s <span class="math inline">\(是点2的强连接F点，\)</span>F_2^w$
是弱连接F点，（弱连接的相关计算可选可不选，选上能够使插值更精确）。</p>
<p>看起来复杂，但思想是：F点k对点i的影响，用k的C点邻居来近似表示。</p>
<p>对于粗网格点（C点）：插值规则非常简单：</p>
<p><strong>每个C点直接对应粗网格中的一个点，权重为1，其他粗网格点权重为0。</strong></p>
<h2 id="例子-1">3.1 例子</h2>
<p><strong>C点 = {1, 3}</strong>，<strong>F点 = {2}</strong></p>
<ul>
<li><p>点1：C点，<span class="math inline">\(u_1 = 1*u_{c1}+0 *
u_{c2}\)</span></p></li>
<li><p>点3：C点，<span class="math inline">\(u_3 = 0 \cdot u_{c1} + 1
\cdot u_{c2}\)</span></p></li>
<li><p>点2：F点， <span class="math display">\[
u_2 = -\frac{\sum_{j \in C_2} a_{2j} u_j}{a_{22}}= -\frac{a_{21} u_1 +
a_{23} u_3}{2} = -\frac{(-1) u_1 + (-1) u_3}{2} = \frac{u_1 + u_3}{2} =
0.5 u_1 + 0.5 u_3
\]</span></p></li>
</ul>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    

<p id="hitokoto">加载中...</p>
<script>
    fetch('https://v.api.aa1.cn/api/yiyan/index.php')
        .then(response => response.text())
        .then(data => {
            // 创建临时元素来提取纯文本
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = data;
            document.getElementById('hitokoto').innerText = tempDiv.textContent || tempDiv.innerText;
        })
        .catch(error => {
            console.error('请求失败:', error);
            document.getElementById('hitokoto').innerText = '一言加载失败';
        });
</script>

 <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
 </p>
</footer>




<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->






</html>
